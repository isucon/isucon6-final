{{define "content"}}

<div class="row">
  {{range $item := .Messages}}
    <p class="alert alert-{{$item.Kind}}">{{if $item.MessageHTML}}{{$item.MessageHTML}}{{else}}{{$item.Message}}{{end}}</p>
  {{end}}
</div>

{{if .Team}}
<div class="row">
  <h2>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚­ãƒ¥ãƒ¼</h2>
  <p>
  {{range .Jobs}}
  <span class="label {{if (eq .Status "running")}}label-success{{else}}label-default{{end}}">{{.TeamID}}{{if (eq $.Team.ID .TeamID)}}*{{end}}</span>
  {{end}}
  </p>
  <form action="/queue" method="POST">
    {{if .Team.IPAddr}}
      <div class="form-group">
        <input class="btn btn-primary" type="submit" value="Enqueue">
      </div>
    {{else}}
      <p class="alert alert-warning">ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã®ã€Œé‹å–¶å‘ã‘æƒ…å ±ã€ã‹ã‚‰IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚</p>
      <div class="form-group">
        <input class="btn btn-primary" type="submit" value="Enqueue" disabled>
      </div>
    {{end}}
  </form>
</div>
{{end}}

<div class="row">
  <h2>ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰</h2>

  {{if .IsRankingFixed}}
    <p class="alert alert-warning">ç«¶æŠ€æ®‹ã‚Š1æ™‚é–“ã‚’åˆ‡ã‚Šã¾ã—ãŸã€‚è‡ªãƒãƒ¼ãƒ ã‚’é™¤ãã€ã‚¹ã‚³ã‚¢ã®è¡¨ç¤ºã¯å›ºå®šã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
  {{end}}

  <div id="plot" style="height: 300px;"></div>
  <script>
    Highcharts.setOptions({useUTC: false});
    new Chartkick.LineChart("plot", {{.PlotLines}}, {min: 0});
  </script>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Team</th>
        <th>Score</th>
        <th>Time</th>
      </tr>
    </thead>
    <tbody>
      {{range $i, $latestScore := .LatestScores}}
        <tr {{if $.Team}}{{if (eq $latestScore.TeamID $.Team.ID)}}class="warning"{{end}}{{end}}>
          <td>{{plusOne $i}}</td>
          <td>{{if (eq "ğŸ‘¼" $latestScore.TeamName)}}<img src="//cdn.jsdelivr.net/emojione/assets/png/1f607.png?v=2.2.6" style="width:1.5em;height:1.5em;" alt=":innocent:">{{else}}{{$latestScore.TeamName}}{{end}}</td>
          <td>{{$latestScore.Score}}</td>
          <td>{{$latestScore.At}}</td>
        </tr>
      {{end}}
    </tbody>
  </table>
</div>

{{if $.Team}}
<div class="row">
  <h2>ã‚ãªãŸã®ãƒãƒ¼ãƒ ã®å±¥æ­´</h2>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Time</th>
        <th>PASS/FAIL</th>
        <th>Score</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody>
      {{range $i, $r := .TeamResults}}
        <tr>
          <td>{{$r.At}}</td>
          <td>{{if $r.Pass}}PASS{{else}}FAIL{{end}}</td>
          <td>{{$r.Score}}</td>
          <td>
            {{if $r.Msg}}<button type="button" class="btn btn-default btn-sm" data-toggle="modal" data-target="#msg-{{$r.ID}}">è¦‹ã‚‹</button>{{end}}
            <!-- Modal -->
            <div class="modal fade" id="msg-{{$r.ID}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">{{$r.At}} [{{if $r.Pass}}PASS{{else}}FAIL{{end}}] {{$r.Score}}</h4>
                  </div>
                  <div class="modal-body">
                    <pre><code>{{$r.Msg}}</code></pre>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      {{end}}
    </tbody>
  </table>
</div>
{{end}}

{{if .Team}}
<div class="row">
  <h2>é‹å–¶å‘ã‘æƒ…å ±</h2>
  <form action="/team" method="POST">
    <div class="form-group">
      <label>ã‚°ãƒ­ãƒ¼ãƒãƒ«IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
      <input class="form-control" type="text" name="ip_address" value="{{.Team.IPAddr}}" autocomplete="off">
    </div>
    <div class="form-group">
      <label>ç«¶æŠ€ã«ä½¿ç”¨ã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åï¼ˆã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§4å€‹ã¾ã§ï¼‰</label>
      <input class="form-control" type="text" name="instance_name" value="{{.Team.InstanceName}}" autocomplete="off">
    </div>
    <div class="form-group">
      <input class="btn btn-primary" type="submit" value="æ›´æ–°">
    </div>
  </form>
</div>
{{end}}

{{end}}
